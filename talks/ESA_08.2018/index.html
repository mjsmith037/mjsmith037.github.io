<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Darwin's Weekly 02.2018</title>

    <link rel="stylesheet" href="../../reveal.js/css/reveal.css">
    <link rel="stylesheet" href="../../reveal.js/css/theme/white.css" id="theme">

    <!-- personal css file -->
    <link rel="stylesheet" href="main.css">
    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="../../reveal.js/lib/css/googlecode.css">
    <!-- font-linking -->
    <link href="https://fonts.googleapis.com/css?family=Alegreya+SC|Alegreya:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-TXfwrfuHVznxCssTxWoPZjhcss/hp38gEOH8UPZG/JcXonvBQ6SlsIF49wUzsGno" crossorigin="anonymous">
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
    <!-- <script src="../../../ForLocalPresentations/jquery-3.3.1.min.js"></script> -->
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <div class="wnotes vcenter">
            <img class="plain" style="max-width:80%;padding-bottom:5vh;" src="Images/title.png">
            <p><b>Matt Michalska-Smith</b><br>Zachary Miller<br>Stefano Allesina</p>
          </div>
          <aside class="notes">
            <p>
              This talk was originally prepared for a departmental seminar entitled Darwin's Weekly,
              at the University of Chicago Department of Ecology &amp; Evolution on
              2 February 2018. It was modified from this to be presented at the Annual Meeting
              of the Ecological Society of America on 6 August 2018.
              Text here will supplement slide material.
            </p><p>
              You can remove this pane (and get it back) by tapping <span class="key">v</span> on your keyboard.
            </p><p>
              Some of the slides will have animations which require advancing the
              slide partway through these explanations. These will be indicated by
              "<span id="ns">next slide</span>" in these notes.
            </p><p>
              Slides can be advanced by tapping<span class="key"><i class="fas fa-arrow-alt-right"></i></span>
              to display only the core slides, or <span class="key">Spc</span>,
              <span class="key">PgDn</span>, or <span class="key">n</span> to also show
              some supplemental slides throughout the presentation.
            </p><p>
              Finally, this presentation will look best in full-screen, but should
              be more or less intelligible on smaller screens (no guarantees about phone screens).
              So, whenever you're ready...
            </p>
            <span id="ns">next slide</span>
          </aside>
        </section>


        <section class="center">
          <div class="wnotes vcenter">
            <div style="width:75%;display:flex;flex-direction:row;align-items:baseline;justify-content:space-around;">
              <div>
                <img class="plain" style="width:20vw;" src="Images/Stefano.jpg">
                <h1 style="font-size:125%">Stefano Allesina</h1>
              </div>
              <div>
                <img class="plain" style="width:20vw;" src="Images/Zach.jpg">
                <h1 style="font-size:125%">Zachary Miller</h1>
              </div>
            </div>
          </div>
          <div style="position:absolute;bottom:0;left:5%;" id="abs_pos">
            <img class="plain" src="../NSF_logo.png" style="display:inline-block;height:10vh;">
            <img class="plain" src="../DeptofEd_logo.png" style="display:inline-block;height:10vh;">
            <img class="plain" src="../NutNet_logo.png" style="display:inline-block;height:10vh;">
            <img class="plain" src="../UC_logo.png" style="display:inline-block;height:10vh;">
          </div>
          <aside class="notes">
            <p>
              This work was conducted with Stefano Allesina and Zach Miller at the
              University of Chicago, with funding from NSF and the Department of
              Education. For an example later in this talk, I will be utilizing
              data from the Nutrient Network.
            <p>
          </aside>
        </section>

        <section>
          <h4 id="header">Outline</h4>
          <div class="wnotes vcenter">
            <ol style="font-size:130%;">
              <li class="fragment highlight-red">A motivating example</li>
              <li>What is known</li>
              <li>What we've done</li>
              <li>What remains</li>
            </ol>
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              A brief outline of the talk today. We're going to start with an
              example to highlight what we are talking about when we say gradient, ordination,
              etc. Then move into some of the historical work on this problem before
              moving on to what we've done so far and a few things that are still
              left to be done.
            </p><p>
              Without further ado, let's get started...
            </p><span id="ns">next slide</span><p>
              by looking at this problem using a concrete example.
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">A motivating example</h4>
          <div class="wnotes vcenter" style="flex-wrap:nowrap;flex-direction:row;max-height:85vh;padding-top:5vh;">
            <img class="plain" src="Images/mountainside.png" style="max-width:45vw;margin-top:10vh;">
            <img class="plain" src="Figures/scrambled_occurance_highlight.svg" style="max-width:40vw;">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              This project stemmed from a statistical observation that arises when
              one is dealing with data strongly influenced by an underlying,
              one-dimensional gradient. Think, for example, of species distributions
              on the side of a mountain. For each species, there will be an elevation
              with the greatest abundance, and some probability of observing a member
              of the species outside of that elevation which decreases with distance.
            </p><p>
              Thus, if we were to sample species presence/absence data along this
              elvational gradient, we might collect a presence/absence matrix that looks something
              like the one here on the right. Here, each row is a site, for which
              we have recorded either the presence (red cell) or absence (white cell)
              of each species found anywhere on the mountain.
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">A motivating example</h4>
          <div class="wnotes vcenter" style="display:flex;flex-wrap:nowrap;flex-direction:row;max-height:85vh;padding-top:5vh;">
            <img class="plain" src="Figures/scrambled_occurance.svg" style="max-width:40vw;">
            <i class="fal fa-arrow-circle-right" aria-hidden="true" style="font-size:3vw;position:relative;"></i>
            <img class="plain" src="Figures/raw_presabs_pca.svg" style="position:relative;">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              If we were to run a principal component analysis on this raw data,
              a surprising pattern emerges: a distinctive arch in the PCA space.
              In fact, every time one does a pca on data generated by an underlying
              one-dimensional gradient, this arch appears as a sort of signature
              of this fact.
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">A motivating example</h4>
          <div class="wnotes vcenter" style="display:flex;flex-wrap:nowrap;flex-direction:row;max-height:85vh;padding-top:5vh;">
            <img class="plain" style="width:55%;" src="Images/mountainside.png">
            <div class="vcenter" style="position:relative;width:3%;">
              <div class="fragment fade-out" style="position:absolute;bottom:45%;" data-fragment-index="1">
                <h1 style="font-size:200%;color:#fff;margin:0;padding:0;">?</h1>
                <i class="fal fa-arrow-circle-right" aria-hidden="true" style="font-size:3vw;position:relative;"></i>
              </div>
              <div class="fragment fade-in" style="position:absolute;bottom:45%;" data-fragment-index="1">
                <h1 style="font-size:200%;margin:0;padding:0;">?</h1>
                <i class="fal fa-arrow-circle-left" aria-hidden="true" style="font-size:3vw;position:relative;"></i>
              </div>
            </div>
            <img class="plain" src="Figures/raw_presabs_pca.svg" style="width:40%;">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              So, we know that if we have data influenced by some underlying
              gradient in the data, we will see this arch in the PCA, but what
              can we do with this information? It would be more useful if,
              having observed this arch phenomenologically, we were then able to
              go backwards...
            </p><span id="ns">next slide</span><p>
              and find the proper order of the data according to the underlying
              gradient. We could then try to find a strong correlate with this
              ordering in order to make some testable predictions about potential
              causal relationships in the Ecology of the species being analyzed.
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">Outline</h4>
          <div class="wnotes vcenter">
            <ol style="font-size:130%;">
              <li>A motivating example</li>
              <li class="red">What is known</li>
              <li>What we've done</li>
              <li>What remains</li>
            </ol>
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            So, what is already known about this pattern in ordination analyses?
          </aside>
        </section>

        <section>
          <h4 id="header">What is known</h4>
          <div class="wnotes vcenter">
            <img class="plain" src="Images/horseshoe_examples_Wartenberg1987.png" style="height:85vh;">
          </div>
          <h4 id="citation" class="citwnotes"><a href="https://www.jstor.org/stable/2461691">Wartenberg, Ferson &amp; Rohlf 1987</a></h4>
          <aside class="notes">
            <p>
              Ecologists have been interested in ordination for a long time and
              fairly early on, Principal Component Analysis (PCA) was identified
              as a powerful, <b>agnostic</b> tool in this effort. For instance,
              this figure, shows six (well, I'm not convinced by the bottom row,
              but at least four) examples of the arch pattern across a range of
              disciplines from Psychology (A) to Ecology (B) to Astronomy (C) to
              Archaeology (D). For a period of time, the arch observed in PCA of
              one dimensional data was viewed as a statistical artifact, distorting
              what was known to be an underlying linear gradient, but due
              in part to an increasing understanding of the mathematics
              uderlying the arch, efforts, starting with this publication by
              Wartenberg, Ferson, and Rohlf in 1987, have shifted away from
              "correcting" the ordination coordinates. Nevertheless, the
              presence of the arch still presents challenges for extracting the
              optimal ordering of the data.
            </p><p style="font-size:60%;">
              Original Legend from Wartenberg Ferson, and Rohlf 1987:<br>
              FIG. 2.-A few examples of
              curvature of component scores from many fields of study. A,
              Psychology, Nonmetric, multidimensional scaling ordination of
              "judged similarities among 14 approximately spectral colors"
              (after Shepard 1978). The numbers correspond to wave- lengths.
              Subjects rated their perceived pairwise similarity between all
              possible pairs of 14 objects each with a different color. The
              derived arch shows a progression from long- wavelength colors
              (reds) to short-wavelength colors (blues). B, Ecology, Principal-
              components-analysis ordination of pitfalls based on species of
              lycosid spiders (after van der  Aart 1973). The distribution of
              pitfalls along the observed arch reflects a sequence of biotopes
              with vegetation changing from bare sand and lichens at one end
              through grassy areas, meadows, parks with shrubs, and, finally,
              relatively dense woods. The symbols correspond to classes of
              pitfalls. C, Astronomy, Nonmetric, multidimensional scaling
              ordination of galaxy types based on Mahalonobis distance using
              morphological data such as size, color, brightness, etc. (after
              Nathanson 1971). The letters correspond to types of galaxies. The
              arch reflects a gradual transition in the physical properties of
              each galaxy. D, Archaeology, Nonmetric, multidimensional scaling
              ordination of graves in La Tene cemetery at Munsingen- Rain based
              on the presence or absence of artifacts found within (after
              Kendall 1971). The numbers represent Hodson's ordering of the
              graves. E, Anthropology, Procrustes ordination of humanoid
              populations based on skull characteristics (after Gower and Digby
              1981). Groupings of points represent different populations. F,
              Sociology, Principal-components- analysis ordination of U.S.
              cities based on the frequency of different types of crimes (after
              Gower and Digby 1981).
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">What is known</h4>
          <div class="wnotes vcenter" style="display:flex;flex-wrap:nowrap;flex-direction:row;">
            <img class="plain" src="Figures/raw_presabs_pca.svg" style="width:40%;">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            The problem posed by the arch is rather intuitive -- though it it clear
            that the points are in some order as you move along the arch, it is
            difficult to be sure of the correct ordering of adjacent points due to
            the scatter. One way that has been seen to make the arch a bit better
            behaved is to run the PCA on a symmetric distance matrix, rather than
            on the raw data.
          </aside>
        </section>

        <section>
          <h4 id="header">What is known</h4>
          <div class="wnotes vcenter">
            <div class="vcenter" style="position:absolute;display:flex;flex-wrap:nowrap;flex-direction:row;width:100%;">
              <img class="plain" src="Figures/scrambled_occurance.svg" style="width:30%;">
              <i class="fal fa-times" style="font-size:3vw;"></i>
              <img class="plain" src="Figures/scrambled_occurance_T.svg" style="width:15%;">
              <i class="fal fa-equals" style="font-size:3vw;"></i>
              <img class="plain" style="width:17%;" src="Figures/scrambled_distance_matrix.svg">
            </div>
            <div class="fragment vcenter" style="position:absolute;display:flex;flex-wrap:nowrap;flex-direction:row;width:100%;">
              <img class="plain" src="Figures/occurance.svg" style="width:30%;">
              <i class="fal fa-times" style="font-size:3vw;"></i>
              <img class="plain" src="Figures/occurance_T.svg" style="width:15%;">
              <i class="fal fa-equals" style="font-size:3vw;"></i>
              <img class="plain" style="width:17%;" src="Figures/distance_matrix.svg">
            </div>
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              For our purposes, we can take a very simple distance metric, where we
              first normalize the adjacency matrix and then multiply it by its transpose.
              This produces a matrix where high values indicate that the row and column
              species have many presences and absences in common. When we do this with
              our toy data from earlier, we get this new "projection" matrix.
              Interestingly, if species distributions are laid out as I suggested,
              then nearby sites should have similar species compositions, and if we
              were to re-order the species into the right configuration (e.g. by order
              of the elevational center of their distribution)
            </p><span id="ns">next slide</span><p>
              a pattern appears in both the occurance matrix and this new distance matrix.
              Note that there is some artifactually higher values in the lower left and
              upper right corners. This is due to an interaction between our simulating
              framework and the normalization we do on the occurance matrices prior to
              multiplying them. Basically, these species look more similar than they ought
              because they share many absences, even though their presences are nearly
              all unshared.
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">What is known</h4>
          <div class="wnotes vcenter" style="display:flex;flex-wrap:nowrap;flex-direction:row;">
            <img class="plain" src="Figures/raw_presabs_pca.svg" style="width:40%;">
            <i class="fal fa-arrow-circle-right" aria-hidden="true" style="font-size:3vw;"></i>
            <img class="plain" src="Figures/pca_standalone.svg" style="width:40%;">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            This cleans up the arch considerably, but there is still some scatter and
            a non-uniform distribution of points along the arch.
          </aside>
        </section>

        <section>
          <h4 id="header">What is known</h4>
          <div class="wnotes vcenter">
            <div style="position:absolute;width:100%;">
              <img class="plain" src="Figures/1d_bounded_large_split_noeigs.svg" style="max-height:45%;margin-bottom:0;padding-bottom:0;">
              <img class="plain fragment" src="Figures/1d_looping_large_split_noeigs.svg" style="max-height:45%;margin-top:0;padding-top:0;">
            </div>
            <div class="fragment" style="position:absolute;width:100%;">
              <img class="plain" src="Figures/1d_bounded_large_justeigs.svg" style="max-height:45%;margin-bottom:0;padding-bottom:0;">
              <img class="plain" src="Figures/1d_looping_large_justeigs.svg" style="max-height:45%;margin-top:0;padding-top:0;">
            </div>
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              When looking at large datasets, we see this distance matrix approaching
              what is called a "Toeplitz" structure in mathematics. When the gradient
              loops back upon itself,
            </p><span id="ns">next slide</span><p>
              the matrix instead converges toward a structure known as "Circulant"
              and produces a corresponding circle in PC space.
            </p><p>
              The final piece of history was quite recently brought into the spotlight in Ecology
              in a paper by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3989108/">Novembre &amp; Stephens</a>. It turns out that
              the reason for this arch actually stems from the fact that PCA is an
              eigenvalue decomposition. An efficient means for compressing information
              is to sum a sequence of sinusoidal curves. This is the method used for
              compressing images into the <code style="font-size:80%;">.jpeg</code> format,
              or audio files into <code style="font-size:80%;">.mp3</code>'s.
            </p><span id="ns">next slide</span><p>
              Likewise, the PCA tries to compress our occurance data and ends up
              using the exact same process, leading to what is termed the
              <a href="https://en.wikipedia.org/wiki/Discrete_cosine_transform">Discrete Cosine Transform</a>
              for the bounded case (i.e. for the Toeplitz Matrix), and the
              <a href="https://en.wikipedia.org/wiki/Discrete_Fourier_transform">Discrete Fourier Transform</a>
              in the looping (i.e. Circulant) one. These are both sinusoidal
              decompositions and provide a nice intuition for why the PC plot produces
              the characteristic arch in these datasets.
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">Outline</h4>
          <div class="wnotes vcenter">
            <ol style="font-size:130%;">
              <li>A motivating example</li>
              <li>What is known</li>
              <li class="red">What we've done</li>
              <li>What remains</li>
            </ol>
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            Alright, now that we have a bit of a foundation, let's jump into what
            we've added to this discussion.
          </aside>
        </section>

        <section>
          <h4 id="header">What we've done</h4>
          <div class="wnotes vcenter">
            <img class="plain" src="Figures/simulation_framework_0.svg" style="position:absolute;">
            <img class="fragment plain" src="Figures/simulation_framework_1.svg" style="position:absolute;" data-fragment-index="1">
            <img class="fragment plain" src="Figures/simulation_framework_4.svg" style="position:absolute;" data-fragment-index="2">
            <img class="fragment plain" src="Figures/simulation_framework_5.svg" style="position:absolute;" data-fragment-index="3">
            <img class="fragment plain" src="Figures/simulation_framework.svg" style="position:absolute;" data-fragment-index="4">
            <span class="fragment" style="width:100%;height:100%;background-color:#ffffff;opacity:0.5;" data-fragment-index="5"></span>
            <img class="fragment plain" src="Figures/occurance_T.svg" style="position:absolute;" data-fragment-index="5">
          </div>
          <aside class="notes">
            <p>
              First, I'm going to lay out the simulation framework used to create
              all of the datasets seen so far in the talk. We can simulate
              a gradient quite simply as a line, where one can think of one end as
              the low end and the other as the high end of the gradient.
            </p><span id="ns">next slide</span><p>
              Along this gradient, we will sprinkle some sampling sites according
              to a prescribed distribution. For this talk, I am always using a uniform
              distribution, but this is easy to adjust.
            </p><span id="ns">next slide</span><p>
              Next, we sprinkle some species. These lines indicate what will be the
              centers of each species' distribution, which, in the case of normally
              distributed species, is the location of their most likely observance.
              Again, I am distributing these centers uniformly in this talk for
              convenience of presentation, but changing this and other
              assumptions in this simulation framework is a key area of further
              research.
            </p><span id="ns">next slide</span><p>
              Finally, each of these species will have some distribution around that center.
              For this figure and throughout the talk, I am just using a simple normal
              distribution. Within the framework, it is quite easy to change both
              the distribution used by each species, as well as to make it such that
              different species have different distribution kernels.
            </p><span id="ns">next slide</span><p>
              And, of course, these simulated datasets have more than 10 sites and
              5 species, so there are actually very many more sites and species distributions
              at a time...
            </p><span id="ns">next slide</span><p>
              leading to occurance matrices like our example from earlier in the
              presentation. Importantly, because we know the locations of each site
              and the centers of each species' distribution, we know how to order
              this matrix to make the gradient apparent. When testing our algorithm,
              we will randomize this matrix prior to searching in order to test our
              ability to recover this known ordering.
          </aside>
        </section>

        <section>
          <section>
            <h4 id="header">What we've done</h4>
            <div class="wnotes vcenter">
              <!-- <img src="Figures/scrambled_occurance.svg" class="plain" style="width:33%;">
              <img class="plain" src="Figures/1d_bounded_large_scrambled.svg" style="width:100%;"> -->
              <img src="Figures/occurance.svg" class="plain" style="width:33%;">
              <img class="plain" src="Figures/1d_bounded_large.svg" style="width:100%;">
            </div>
            <h4 id="citation" class="citwnotes"></h4>
            <aside class="notes">
              <p>
                From this occurance matrix, we can normalize and multiply by it's transpose to get
                the distance matrix, as mentioned before, and the PCA and eigenvectors of this
                matrix can likewise be plotted. Looking at this properly ordered case, it is
                apparent that there are multiple potential avenues of approach if we wanted to go
                backwards to extract this ordering.
              </p><p>
                First, one could look at the PCA plot iself, since this is order invariant,
                and try to trace along the arch to get the proper ordering. Though this
                looks easy in this case, this is a large simulated matrix with low variance
                leading to a very clean arch that is usually not the case in real data.
              </p><p>
                Likewise, one could try rearranging the eigenvector components to best fit
                the known theoretical transform. Again, we would run into some issues with
                noisy data, but it is an option.
              </p><p>
                Finally, one could work with the distance matrix, or, equivalently the
                occurance matrix, directly, rearranging rows or columns in order to put the most
                similar rows/columns next to one another. This is the path we've chosen as, in
                the early stages of prototyping and testing, it was shown to be both faster and
                more consistent at generating favorable results compared to fitting the eigenvectors.
              </p>
            </aside>
          </section>

          <section>
            <h4 id="header">What we've done</h4>
            <!-- <section> -->
              <div class="wnotes vcenter">
<pre style="max-width:66vw;"><code data-trim class="stretch r">
# take a binary occurance matrix B
# for a decreasing neighborhood size d
for (d in ncol(B) / 2, ncol(B) / 4, ncol(B) / 8, ..., 2, 1) {
  # loop through each column to get the contribution to the total score
  for (each column_i in B) {
    for (each column_j in B) {
      # measure the euclidean distance between the two columns
      distance_i[j] &lt;- sqrt(sum((column_i - column_j)^2))
    }
    # rank the distance to each other column
    rank_distance_i &lt;- rank(distance_i)
    # add the ranks of the columns within d steps of the target column
    for (each column_j within d steps of column_i) {
      total_score &lt;- total_score + sum(rank_distance_i[j])
    }
  }
}
</code></pre>
              </div>
              <h4 id="citation" class="citwnotes"></h4>
              <aside class="notes">
                We utilized a
                <a href="https://darrenjw.wordpress.com/2013/09/29/parallel-tempering-and-metropolis-coupled-mcmc/">Metropolis-Coupled Markov Chain Monte Carlo</a>
                (MCMCMC, or MC$^3$) stochastic search algorithm. The core functionality
                of this algorithm is the fitness function, which is what this pseudocode
                outlines. Basically, a good fit is one in which, for each column, the
                other columns that are most similar to the target column/row are also the
                nearest in position. To quantify this, we rank the distances to every
                other column from a target column and then sum those ranks for a local
                neighborhood around that target column, finally summing those values
                for every column/row in the matrix. Thus, the lower this value, the more
                low-rank distance columns/rows are nearby the target column/row and the
                better the fit. To improve the quality of the final fit, we narrow in the
                neighborhood of interest, starting with a broad neighborhood and getting
                down to just considering the immediate neighbors of each column/row.
              </aside>
            </section>
          </section>

        <section>
          <h4 id="header">What we've done</h4>
          <div class="wnotes vcenter">
            <img class="plain" style="position:absolute;" src="Figures/Simmat_Before.svg">
            <img class="plain fragment" style="position:absolute;" src="Figures/Simmat_After.svg" data-fragment-index="1">
            <span class="fragment" style="width:100%;height:100%;background-color:#ffffff;opacity:0.5;position:absolute" data-fragment-index="2"></span>
            <img class="plain fragment" style="position:absoulte;z-index:50;" src="Figures/compare_simmat_orderings.svg" data-fragment-index="2">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              So, how does this work? We can test it with our simulated data. This is
              how the results look when they are first generated, and ...
            </p><span id="ns">next slide</span><p>
              this is how the best solution found from a randomized starting configuration
              looks. If you can't see the difference, that is a good thing -- it means we
              were able to recover near the optimal ordering. This can be further demonstrated
              if we plot the two orderings against one another.
            </p><span id="ns">next slide</span><p>
              As you can see, there are a few swaps, but in general, this is a
              correlation of greater than 0.95. Also note the fitness scores
              shown in the axes labels -- we actually found a better fit (lower
              distance value) than the original. This could be due to a mismatch
              between our fitness measure and the optimal ordering, or it could
              be that, due to the stochastic nature of the data generation, this
              new order is actually more parsimonious than the original.
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">What we've done</h4>
          <div class="wnotes vcenter" style="display:flex;flex-wrap:nowrap;flex-direction:row;max-height:85vh;padding-top:5vh;">
            <img class="plain" style="position:absolute;left:0;max-width:65%" src="Images/Nutnet_GreatPlains_bw.png">
            <img class="plain" style="position:absolute;right:0;max-width:35%;" src="Images/Nutnet_PCA_bw.svg">
            <img class="plain fragment" style="position:absolute;left:0;max-width:65%" src="Images/Nutnet_GreatPlains.png" data-fragment-index="1">
            <img class="plain fragment" style="position:absolute;right:0;max-width:35%;" src="Images/Nutnet_PCA.svg" data-fragment-index="1">
            <img class="plain fragment" style="position:absolute;right:0;max-width:35%;" src="Images/Nutnet_PCA_wline.svg" data-fragment-index="2">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              So, the algorithm works, at least with highly controlled, simulated data. What about
              in the real world? This map shows a subset of the experimental sites taking part in
              the <a href="http://www.nutnet.umn.edu/">Nutrient Network</a> -- a replicated experiment
              which contains plots of land for which plant percent cover data has been collected
              for over a decade. If we build an occurance matrix analogous to thos shown earlier in
              the talk, i.e. species x plot, and perform the usual analysis of buiding a distance
              matrix and running a PCA on it, we see our familiar arch.
              Even more exciting, if we color the sites by longitude,
            </p><span id="ns">next slide</span><p>
              We see a clear pattern along the arch, which can be accentuated by a path drawn
              between the mean positions for each longitude:
            </p><span id="ns">next slide</span><p>
              The one extreme outlier in this case, the light blue in the upper right, is the site
              in Tyson, MO. Remarkably, this site is about to be closed down because it is suffering
              a rapid invasion of species more common in the Eastern US.
            </p>
          </aside>
        </section>

        <section>
          <h4 id="header">What we've done</h4>
          <div class="wnotes vcenter">
            <img class="plain" src="Figures/Empirical_Before.svg" style="position:absolute;">
            <img class="plain fragment" src="Figures/Empirical_After.svg" style="position:absolute;" data-fragment-index="1">
            <span class="fragment" style="width:100%;height:100%;background-color:#ffffff;opacity:0.5;position:absolute" data-fragment-index="2"></span>
            <img class="plain fragment" style="position:absoulte;z-index:50;" src="Figures/compare_empirical_orderings.svg" data-fragment-index="2">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              So how does our algorithm fare with this relatively nice, though clearly more
              noisy, empirical case? Here is the before picture, with the plots clustered by
              site, but unordered otherwise.
            </p><span id="ns">next slide</span><p>
              And here is the best found ordering of the plots. The change here is
              harder to interpret. the eigenvetors are smoother, but certainly not
              obviously related to the expected discrete cosine transformation. Likewise,
              the distance matrix looks a little closer to Toeplitz structure, but still
              not especially close.
            </p><span id="ns">next slide</span><p>
              If we again plot the new order agains the old, we tend to see clusters of points
              rearranged in the new order. These are whole sites being moved, rather than
              individual plots being picket out of sites. The next steps will be to see if this
              best-found order correlates with any of the known metainformation we have for the
              sites in question, for instance longitude.
          </aside>
        </section>

        <section>
          <h4 id="header">Outline</h4>
          <div class="wnotes vcenter">
            <ol style="font-size:130%;">
              <li>A motivating example</li>
              <li>What is known</li>
              <li>What we've done</li>
              <li class="red">What remains</li>
            </ol>
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            Alright, so other than fur, what are someter exploring potential correlates on
            the emprical results, I am excited to also further explore this simulation framework
            to get a feel for the importance of variation at various stages in ordering recoverability.
          </aside>
        </section>

        <section>
          <h4 id="header">What remains</h4>
          <div class="wnotes vcenter">
            <ul class="fa-ul" style="width:80%;list-style-type:none;">
              <li><i class="fa-li fal fa-angle-right"></i>Identifying rank vs. identifying position</li>
              <li><i class="fa-li fal fa-angle-right"></i>Gradients in more than one dimension</li>
              <li><i class="fa-li fal fa-angle-right"></i>Types of variability</li>
              <ul class="fa-ul" style="width:80%;list-style-type:none;">
                <li><i class="fa-li fal fa-angle-double-right"></i>Species center distribution</li>
                <li><i class="fa-li fal fa-angle-double-right"></i>Site location distribution</li>
                <li><i class="fa-li fal fa-angle-double-right"></i>Species distribution parameters</li>
                <li><i class="fa-li fal fa-angle-double-right"></i>Species distribution class</li>
              </ul>
            </ul>
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            <p>
              It is iportant to be clear about what this algorithm is actually doing; it is not
              identifying the position along the gradient of each species/site. Rather, it is
              identifying a rank-order for the species/sites along the gradient. These are
              different problems, but the latter would be the more powerful result.
            </p><p>
              Second, are there similar patterns in the principal components or eigenvectors
              when a more complicated gradient underlies the data, such as a two or more
              dimensional gradient? This is something that has been under-explored, but which
              is quite easy to investigate using the framework explained in this talk.
            </p><p>
              A third area of expansion is more clearly defining the limits to our inference.
              Explicitly, how does introducing variation at different levels of the simulation
              affect our ability to consistently recover the proper orderings?
            </p>
          </aside>
        </section>

        <section class="center">
          <div class="wnotes vcenter">
            <h1 style="width:100%;font-size:300%;">Questions?</h1>
            <p style="position:absolute;bottom:20%;width:100%;text-align:center;"><a href="http://michalska-smith.com/talks/">Slides available on Michalska-Smith.com</a></p>
          </div>
          <aside class="notes">
            <p>
              Thanks for viewing this presentation, if you have any feedback or
              questions, please <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#109;&#106;&#115;&#109;&#105;&#116;&#104;&#064;&#117;&#099;&#104;&#105;&#099;&#097;&#103;&#111;&#046;&#101;&#100;&#117;">Email me</a>!
            <p>
          </aside>
        </section>

        <section>
          <h4 id="header">Gradients in higher dimensions</h4>
          <section>
            <div class="wnotes vcenter">
              <img class="plain" src="Figures/2d_bounded.svg" style="max-height:30%;margin:0;padding:0;">
              <img class="plain" src="Figures/3d_bounded.svg" style="max-height:30%;margin:0;padding:0;">
              <img class="plain" src="Figures/4d_bounded.svg" style="max-height:30%;margin:0;padding:0;">
            </div>
            <aside class="notes">
              What do the ordinations of higher-dimensional gradients look like? Here
              are figures for 2, 3, and 4 dimensional gradients.
            </aside>
          </section>

          <section>
            <div class="wnotes vcenter">
              <img class="plain" src="Figures/3d_pca_table.png" style="top:5vh;">
            </div>
            <aside class="notes">
              Here are extended biplots looking at the pairwise combination of
              each of the first four principal components of a three dimensional gradient.
            </aside>
          </section>

          <section>
            <div class="wnotes vcenter">
              <img class="plain" src="Figures/4d_pca_table.png" style="top:5vh;">
            </div>
            <aside class="notes">
              Here are extended biplots looking at the pairwise combination of
              each of the first four principal components of a four dimensional gradient.
            </aside>
          </section>
          <h4 id="citation" class="citwnotes"></h4>
        </section>

        <section>
          <h4 id="header">Increasing species distribution variance</h4>
          <section>
            <div class="wnotes vcenter">
              <img class="plain" src="Figures/1d_bounded.svg" style="max-height:30%;margin:0;padding:0;">
              <img class="plain" src="Figures/1d_bounded_midvar.svg" style="max-height:30%;margin:0;padding:0;">
              <img class="plain" src="Figures/1d_bounded_highvar.svg" style="max-height:30%;margin:0;padding:0;">
            </div>
            <aside class="notes">
              Moving down the page are summary figures of simulated datasets with
              increasing variance of the species distributions (i.e. species span
              over a wider range of sites)
            </aside>
          </section>

          <section>
            <div class="wnotes vcenter">
              <img class="plain" src="Figures/1d_looping.svg" style="max-height:30%;margin:0;padding:0;">
              <img class="plain" src="Figures/1d_looping_midvar.svg" style="max-height:30%;margin:0;padding:0;">
              <img class="plain" src="Figures/1d_looping_highvar.svg" style="max-height:30%;margin:0;padding:0;">
            </div>
            <aside class="notes">
              Similar to the above slide, but in the case of a looping gradient
            </aside>
          </section>
          <h4 id="citation" class="citwnotes"></h4>
        </section>

        <section>
          <h4 id="header">Alternative Distance Metrics</h4>
          <div class="wnotes vcenter">
            <img class="plain" src="Figures/alternative_distance_metrics.svg">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            Looking at the effect of different distance metrics on the arch pattern
            in principal component space.
          </aside>
        </section>

        <section>
          <h4 id="header">Nestedness as Gradient</h4>
          <div class="wnotes vcenter">
            <img class="plain" style="width:33%;" src="Figures/nested_occurance.svg">
            <img class="plain" src="Figures/nested_fullplot.png">
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
            Nestedness is of particular interest in Ecology and can likewise be
            interpreted as a gradient, producing similar results. I'm not sure if the rotation
            of the PCA biplot is a robust result, and I will also be looking into this more in
            the future.
          </aside>
        </section>

        <!-- <section>
          <h4 id="header"></h4>
           <div class="wnotes">
            <div style="padding-top:100px;">

            </div>
          </div>
          <h4 id="citation" class="citwnotes"></h4>
          <aside class="notes">
          </aside>
        </section> -->
      </div>
    </div>

    <script src="../../reveal.js/lib/js/head.min.js"></script>
    <script src="../../reveal.js/js/reveal.js"></script>

    <!-- Custom Javascript -->
    <script>
    $(document).keydown(function(e) {
      var key = e.which;
      if (key == 86) {
          // if the user pressed 'v':
          $("aside.notes").toggleClass("hidden");
          $("aside.notes").siblings().not("#header").not("#citation").not("#slide_position").not("#abs_pos").toggleClass("wnotes");
          $("section > #citation").toggleClass("citwnotes");
      }
    });
    </script>

    <script>
      Reveal.initialize({
        width: "100%",
        height:"100%",
        controls: false,
        progress: true,
        slideNumber: true,
        history: true,
        center: false,
        transition: "slide", // none/fade/slide/convex/concave/zoom
        math: {
      		mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          // mathjax: '../../../ForLocalPresentations/MathJax/unpacked/MathJax.js',
      		config: 'TeX-AMS_HTML-full'
      	},
        // Optional reveal.js plugins
        dependencies: [
          { src: "../../reveal.js/plugin/math/math.js", async: true },
          { src: "../../reveal.js/plugin/notes/notes.js", async: true },
          { src: "../../reveal.js/plugin/highlight/highlight.js", async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });
    </script>
  </body>
</html>
